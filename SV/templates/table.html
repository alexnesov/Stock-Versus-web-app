{%extends "base.html"%}
{%block content%}

<head>
  <link href="/static/style_table.css" rel="stylesheet" type="text/css">
  <title>GTS-Table</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
  <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"/>

</head>

<body id="Table_page">

  <h3>A society (and the market) is an aggregation of micro and macro institutions, and hence <b>patterns.</b></h3>

  <hr>

</br>

  
  <blockquote style="text-align:center"><i>“History doesn’t repeat itself but it often rhymes.”</i>.
  </blockquote>
  <p style="text-align:center"><b>Mark Twain</b></p>

  <p>
    There are many debates about the relevance of technical analysis (TA). <br>
      <br>
    One sure thing, there is a big difference between a person pretending to be Nostradamus and a person concluding that some aggregated behaviors are predictable. <br>
    This sounds obvious, but it doesn't pretend the TA opponents to make such caricatures.
    As usual, the debate is polarized by the opponents, and as usual, things are more nuanced than what it seems first. 
    <br>
    <br>
    
    If I place fire under your hand, you will move your hand. No crystal ball.
    If Kylie Jenner posts some Mascara on Instagram, it will sell more. No crystall ball used here either.
    The thing is to get the right signal at the right moment at the right place and to use reasonable </b>assumptions</b> first.
    Pattern thinking is both admired and despised.
    I personnaly had many discussions with highly educated people in the highest financial insitutions.
    Generally, people are reluctant to technical analysis. </br>
    But being very educated never prevented them to talk before thinking. Often what separates the professional from the layman 
    is institutionnal heritage and pro. sounding words, not rationality.
    9-5 professionals keep reproducing the insitutional pattern they were thaught. Otherwise, they would risk life in a more creative fashion.
    <br>
    <br>
    As a side note, we can generally follow these principles:
    <br>

    <b>1.</b> Don't ask financial advises from people who don't risk their own money, even if they work in finance.
    <br>

    <b>2.</b> And don't ask financial advise to people who risk their own money in such a way they would avoid if they were risking other people's money. 
    <br>
    <br>
    
    Both these principles shouldn't be detached from one another.
    Majority of hedge funds get beaten by the market (they all have GMATS and come out of very pretistigous universities).
    And the vast majority of retail traders loose money.
  </br>
</br>
<b> Why do many professsionals fail? Because they often claim what <i>should be or not</i> from a mecanist point of view, with a very professoral tone, instead of concluding <u>what could probably happen</u>.</b>
</br>
</br>
  We don't pay hedge funds and strategists to give us a moralistic point of view on the economy, <i>i.e.</i> to tell us what <b>"should"</b> be the price of an 
  asset or not. This is political economy.
  We pay them to predict. Usually, they come with moralistic point of views about what is the "right" price out of frustration after they 
  failed to predict price surges 
  (and hence failed to enter in the bandwagon).
</br>
    
    Education never prevented them talking nonsense (such as defending value investing in covid times or the market efficiency hypothesis).
    The absence of evidence echoes of course with discourses that sustain failure in money management.
    This is because univerisites mainly teach hypothetico-deductive thinking, but without the elegance that a mathematican would have.
    And without remembering that the economic (and hence social) world is not lead by the same rules as atoms and gravity.
  </br>
</br>

    In this mess, what is, or are, the remaining solution(s)?
    
    <li><b>Evidence based thinking.</b> It's simple as that. But it's difficult to apply. Requires work, people don't like to work, 
      people prefer slogans over in depth analysis.</li>
    <li><b>Avoid what you learn in institutions.</b> Humans don't like to work, and hence they use institutional tools to think. 
      As the processes are preconceived.
      
    </li>

</br>
    
    For Samuel P. Huntington, <b>Institutions</b> are: 
    <blockquote style="text-align:center"><i>"stable, valued, recurring patterns of behavior"</i>.
    </blockquote>
What I said above particularly echoes to Huntington's sociological view of institutions. 
Incredible isn't it? Patterns are at the very essence of civilization and markets, because institutions are what make people understand each other...and themselves.
Institutions are what makes a society persistent and thus existing.
There is a wide range of possibilities between the simplistic linear models and total randomness. The truth often lies in nuance.
</br>
Our case is no exception I think. Patterns are indeed everywhere. The total randomness assumption is not more absurd than the mecanist one.
And to be honest, I would rather believe a person that has a mecanist point of view on the economy than a person who believes that 
the market are pure noise and randomness (eventhogught I  wouldn't trust such a person with my money either).
</br>
</br>
Institutions are our friends as they helps us yield profits (predictability). <br>
Institution is our ennemy as we shouldn't inherit from institutionnal thinking (inertia and defeat of critical mind). <br>

<br>


  </br>
</br>
 
  <b> In GTS, opinions and biases don't matter, only evidence does. When a person asserts one thing, the next sentence should be argument(s) that prove the claim.</b>
  Preferably, figures.

</p>
</br>
<blockquote style="text-align:center"><i>“We search through historical data looking for anomalous patterns that we would not expect to occur at random”</i>.
</blockquote>
<p style="text-align:center"><b>Jim Simons</b></p>
<h3>Signals</h3>
<hr>

<div class="chart" id="line" style=max-width:100%;overflow:hidden;border:none;padding:0;margin:0 auto;display:block;" marginheight="0" marginwidth="0">
  <script>
    var graphs = {{plot | safe}};
    Plotly.plot('line',graphs,{});
  </script> 
</div>

      <div class="Donut" id="Donut" style=max-width:100%;overflow:hidden;border:none;padding:0;margin:0 auto;display:block;" marginheight="0" marginwidth="0">
        <script>
          var graphs = {{Donut | safe}};
          Plotly.plot('Donut',graphs,{});
        </script> 
      </div>


<hr>

  </p>

    <form class="form" autocomplete="off" spellcheck="false" method="POST">

      </div>
          <div class="row">
            <label for="date_input" class="col-form-label col-form-label-sm">Signals untill: </label>
            
            <div class="col-sm-2">
              {{ form.date_input(class="form-control form-control-sm", type="date", value=strToday | safe)}}
            </div>

            
              <div class="btn-toolbar">
                <input type="submit" class="btn btn-secondary btn-sm mr-2 mb-2" id="validate_date" value="Filter">
                <input type="submit" class="btn btn-secondary btn-sm mr-2 mb-2" id="reset" value="Reset">
                <a href="/getCSV" input class="btn btn-success btn-sm mr-2 mb-2" id="getcsv">Download</a>
            </div>
      </div>

    </form>
  <div>
    <p style="text-align:center">

      {%if average>0%}
      <img alt="dl icon" src="../static/green-arrow.png" width="30" height="30" >
    </br>

      Average overall return: <font color="green"><b>{{average}}</b></font> % 
      {%elif average==0%}
      Average overall return: 0 %
      {%else%}
      Average overall return: <font color="red"><b>{{average}}</b></font> %
      <img alt="dl icon" src="../static/red-arrow.png" width="30" height="30" >
      {% endif %}
    </br>

      {%if SP500evol>0%}
      <b>SP 500</b> evol. over the same period : 
      <font color="green"><b>{{SP500evol}}</b></font> % 
      {%else%}
      <b>SP 500</b> evol. over the same period : 
      <font color="red"><b>{{SP500evol}}</b></font> % 
      {% endif %}
    </br>

    (<strong>{{lastD}}</strong> to <strong>{{firstD}}</strong>)

    </p>

  </div>




</div>


<div class="table-wrapper-scroll-y my-custom-scrollbar" >

<table class="table table-bordered table-striped table-sm table-hover" style=max-width:100%;overflow:hidden;border:none;padding:0;margin:0 auto;display:block;" marginheight="0" marginwidth="0">
  <thead class="thead-dark">
    <th scope="col">ValidTick</th>
    <th scope="col">SignalDate</th>
    <th scope="col">ScanDate</th>
    <th scope="col">NScanDaysInterval</th>
    <th scope="col">PriceAtSignal</th>
    <th scope="col">Last closing price</th>
    <th scope="col">Price Evolution</th>
  </thead>
  {% for item in items %}
  <tr>
    <td>{{ item[0] }}</td>
    <td>{{ item[1] }}</td>
    <td>{{ item[2] }}</td>
    <td>{{ item[3] }}</td>
    <td>{{ item[4] }}</td>
    <td>{{ item[5] }}</td>
    <td>{{ item[6] }}</td>
  </tr>
  {% endfor %}
</table>
</div>
</br>
</br>

<h3>Signals visualization</h3>
<hr>

<p>
  You can enter one of the Symbols present in the table above to visualize the Signals.
  For now, only the stocks marked as signaled can be charted with the tool below.
</p>
<form class="form-inline" method="post" action="/changeSignalChart">
  <div class="form-group mx-sm-3 mb-2">
      {{ form.validChartSignal(class="form-control")}}
  </div>
  <button type="submit" class="btn btn-primary mb-2">Confirm</button>
</form>

<div class="SignalChart" id="SignalChart">
  <script>
    var graphs = {{SignalChart | safe}};
    Plotly.plot('SignalChart',graphs,{});
  </script>
</div>

<p>
  <br>
  <br>

<b>Assumption to test in the future:</b> Taking a longer <i>long_mvg</i> (50&ltmvg<=200) will reduce the number of false positives.
<br>
<br>

</p>


<h4>ATR integration in the strategy</h4>
<hr>


<p>
  Average True Range denotes <b>>voltaility</b>, it doesn't denote trending. "Average" True Range is purely an exponential moving average of the true range.<br> 
<br>

Tje range of a day's trading is simply <i>high</i> - <i>low</i>. The <b>true range</b> extends it to yesterday's closing price
if it was outside of today's range.<br>
<br>
<img src="/static/TR.svg" alt="TR" class="center">

The <b>true range</b> is the largest of the:
<ul>
<li>Most recent period's high minus the most recent period's low</li>
<li>Absolute value of the most recent period's high minus the previous close</li>
<li>Absolute value of the most recent period's low minus the previous close</li>
</ul>
The ATR at the moment of time t is calculated using the following formula:

  <img src="/static/ATR.svg" alt="first_ATR" class="center">
  The first ATR value is calculated using the arithmetic mean formula:
<br>
  <img src="/static/first_ATR_formula.svg" alt="ATR" class="center">


</p>
</code>

</body>
{% include "base_dashboard.html" %}

{%endblock%}

